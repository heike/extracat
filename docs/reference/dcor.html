<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Weighted Distance Correlation — wdcor • extracat</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Weighted Distance Correlation — wdcor" />

<meta property="og:description" content="An efficient implementation of the distance correlation for two variables with the additional option to weight the observations.
The main application for the weights is to use frequencies according to ordinal variables which can be represented by a contingency table (wdcor.table)).
 Another idea is to make the distance correlation more robust by assigning small weights to observations which are far from the rest of the data. 
For large datasets the distance correlation is often said to be too inefficient to be of any great use. The function approx.dcor offers a pretty good approximation of the distance correlation via binning and wdcor.table). 
wdcor.data.frame computes a distance correlation matrix. Factor variables are transformed to integer via data.matrix." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">extracat</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.7.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Weighted Distance Correlation</h1>
    
    <div class="hidden name"><code>dcor.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>An efficient implementation of the distance correlation for two variables with the additional option to weight the observations.
The main application for the weights is to use frequencies according to ordinal variables which can be represented by a contingency table (<code>wdcor.table)</code>).
 Another idea is to make the distance correlation more robust by assigning small weights to observations which are far from the rest of the data.</p> 
<p>For large datasets the distance correlation is often said to be too inefficient to be of any great use. The function <a href='approx.dcor.html'>approx.dcor</a> offers a pretty good approximation of the distance correlation via binning and <code>wdcor.table)</code>.</p> 
<p><code>wdcor.data.frame</code> computes a distance correlation matrix. Factor variables are transformed to integer via <code>data.matrix</code>.</p>
    
    </div>

    <pre class="usage">wdcor(x,&#8230;)
# S3 method for default
wdcor(x,y,w = NULL,ep = 1, approx = FALSE, n = 50,na.rm = TRUE, &#8230;)
# S3 method for table
wdcor(x,ep = 1,&#8230;)
# S3 method for data.frame
wdcor(x, w = NULL, ep = 1, approx = FALSE, n = 50, &#8230;)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A data crosstable or a numeric vector.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>A numeric vector.</p></td>
    </tr>
    <tr>
      <th>w</th>
      <td><p>Weights, typically frequencies. The default weights all cases the same, which leads to the standard distance correlation.</p></td>
    </tr>
    <tr>
      <th>ep</th>
      <td><p>The euclidean (absolute) distances can be taken to the power of <code>ep</code>.</p></td>
    </tr>
    <tr>
      <th>approx</th>
      <td><p>Whether or not to use <a href='approx.dcor.html'>approx.dcor</a> instead of wdcor.
This is automatically chosen for vectors with more than 20000 entries.</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>The number of bins used by <a href='approx.dcor.html'>approx.dcor</a>.</p></td>
    </tr>
    <tr>
      <th>na.rm</th>
      <td><p>Whether or nor to remove missing values.</p></td>
    </tr>
    <tr>
      <th>&#8230;</th>
      <td><p>dots.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The correlation value which is between 0 and 1.</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Automatically uses an approximation for vectors larger than 20000 entries!</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Szekely, G. J. Rizzo, M. L. and Bakirov, N. K. (2007). "Measuring and testing independence by correlation of distances", Annals of Statistics, 35/6, 2769-2794</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='approx.dcor.html'>approx.dcor</a></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># repeat and change N for different results and computation times.</span>
<span class='no'>N</span> <span class='kw'>&lt;-</span> <span class='fl'>2000</span>
<span class='no'>x1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='no'>N</span>,<span class='kw'>mean</span><span class='kw'>=</span><span class='fl'>10</span>,<span class='kw'>sd</span><span class='kw'>=</span><span class='fl'>3</span>)
<span class='no'>x2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Uniform'>runif</a></span>(<span class='no'>N</span>,<span class='fl'>0</span>,<span class='fl'>40</span>)
<span class='no'>x3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='no'>N</span>,<span class='kw'>mean</span><span class='kw'>=</span><span class='fl'>30</span>,<span class='kw'>sd</span><span class='kw'>=</span><span class='fl'>4</span>)
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/sample'>sample</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='no'>x1</span>,<span class='no'>x2</span>,<span class='no'>x3</span>),<span class='no'>N</span>)

<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='fl'>1</span>,<span class='kw'>sd</span><span class='kw'>=</span><span class='fl'>0.0001</span>)*(<span class='no'>x</span>-<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/mean'>mean</a></span>(<span class='no'>x</span>))^<span class='fl'>4</span>+ <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='fl'>1</span>,<span class='kw'>sd</span><span class='kw'>=</span><span class='fl'>0.01</span>)*(<span class='no'>x</span>-<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/mean'>mean</a></span>(<span class='no'>x</span>))^<span class='fl'>3</span>
<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='no'>y</span>+ <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='fl'>1</span>,<span class='kw'>sd</span><span class='kw'>=</span><span class='fl'>0.1</span>)*(<span class='no'>x</span>-<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/mean'>mean</a></span>(<span class='no'>x</span>))^<span class='fl'>2</span>
<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='no'>y</span>+ <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='fl'>1</span>)*(<span class='no'>x</span>-<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/mean'>mean</a></span>(<span class='no'>x</span>))+<span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='no'>N</span>,<span class='kw'>sd</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Uniform'>runif</a></span>(<span class='no'>N</span>,<span class='fl'>3</span>,<span class='fl'>10</span>))
<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='no'>y</span>+ <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Uniform'>runif</a></span>(<span class='no'>N</span>,<span class='fl'>0</span>,<span class='fl'>20</span>)*<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Trig'>sin</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/MathFun'>abs</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/scale'>scale</a></span>(<span class='no'>x</span>))*<span class='fl'>2</span>*<span class='no'>pi</span>)

<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>require</a></span>(<span class='no'>scales</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>x</span>,<span class='no'>y</span>,<span class='kw'>pch</span><span class='kw'>=</span><span class='fl'>19</span>,<span class='kw'>col</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/scales/topics/alpha'>alpha</a></span>(<span class='st'>"black"</span>,<span class='fl'>0.2</span>))</div><div class='img'><img src='dcor-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/system.time'>system.time</a></span>(<span class='no'>dd</span><span class='kw'>&lt;-</span><span class='fu'>wdcor</span>(<span class='no'>x</span>,<span class='no'>y</span>))</div><div class='output co'>#&gt;    user  system elapsed 
#&gt;   0.310   0.029   0.368 </div><div class='input'>
<span class='no'>y2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Uniform'>runif</a></span>(<span class='fl'>2000</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/system.time'>system.time</a></span>(<span class='no'>dde</span><span class='kw'>&lt;-</span><span class='fu'>wdcor</span>(<span class='no'>x</span>,<span class='no'>y2</span>))</div><div class='output co'>#&gt;    user  system elapsed 
#&gt;   0.332   0.014   0.396 </div><div class='input'><span class='no'>dd</span></div><div class='output co'>#&gt; [1] 0.1457353</div><div class='input'><span class='no'>dde</span></div><div class='output co'>#&gt; [1] 0.07414604</div><div class='input'>
</div><span class='co'># NOT RUN {</span>
<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='no'>diamonds</span>$<span class='no'>price</span>
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='no'>diamonds</span>$<span class='no'>carat</span>

<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/length'>length</a></span>(<span class='no'>x</span>) <span class='co'># 53940</span>

<span class='co'># auto approximation via approx.dcor</span>
<span class='fu'>wdcor</span>(<span class='no'>x</span>,<span class='no'>y</span>)

<span class='co'># the weighted distance correlation is also applicable to</span>
<span class='co'># discrete data:</span>

<span class='no'>A</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='arsim.html'>arsim</a></span>(<span class='fl'>2000</span>,<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>12</span>,<span class='fl'>12</span>),<span class='fl'>4</span>,<span class='fl'>0.1</span>)
<span class='fu'>wdcor</span>(<span class='no'>A</span>)
<span class='fu'>wdcor</span>(<span class='fu'><a href='optile.html'>optile</a></span>(<span class='no'>A</span>))
<span class='fu'>wdcor</span>(<span class='fu'><a href='optile.html'>optile</a></span>(<span class='no'>A</span>, <span class='kw'>fun</span> <span class='kw'>=</span> <span class='st'>"distcor"</span>))


<span class='co'># kernel density weights:</span>
<span class='no'>kd</span> <span class='kw'>&lt;-</span> <span class='fu'>kde2d</span>(<span class='no'>x</span>,<span class='no'>y</span>,<span class='kw'>n</span><span class='kw'>=</span><span class='fl'>50</span>)

<span class='no'>xy</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/expand.grid'>expand.grid</a></span>(<span class='no'>kd</span>$<span class='no'>x</span>,<span class='no'>kd</span>$<span class='no'>y</span>)
<span class='fu'>wdcor</span>(<span class='no'>xy</span>[,<span class='fl'>1</span>],<span class='no'>xy</span>[,<span class='fl'>2</span>], <span class='kw'>w</span> <span class='kw'>=</span> <span class='no'>kd</span>$<span class='no'>z</span>)
<span class='co'># this is the approximate distance correlation for the 2D density estimate</span>
<span class='co'># }</span><div class='input'>
<span class='co'># a pairwise matrix:</span>
<span class='no'>D</span> <span class='kw'>&lt;-</span> <span class='fu'>wdcor</span>(<span class='no'>olives</span>[,<span class='fl'>3</span>:<span class='fl'>10</span>])
<span class='fu'><a href='fluctile.html'>fluctile</a></span>(<span class='no'>D</span>^<span class='fl'>2</span>, <span class='kw'>shape</span><span class='kw'>=</span><span class='st'>"c"</span>)</div><div class='img'><img src='dcor-2.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; viewport[base] </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Alexander Pilhoefer</p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Alexander Pilhoefer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

