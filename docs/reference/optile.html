<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Reordering Categorical Data — optile • extracat</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Reordering Categorical Data — optile" />

<meta property="og:description" content="This function will take a categorical data object (data.frame, table, ftable, matrix, array) and optimize its category orders.
Most of the implemented techniques aim for a (pseudo-) diagonalization of the data matrix or table. This improves graphical representations (e.g. by minimizing crossings in scpcp plots) and can also be useful to compute clusters (e.g. via cfluctile).
The function offers an interface which will by default return the same type of object that has been passed to the function such that it is possible to
write  myplot( optile(x) ) for an optimized version of myplot(x). 
It is possible to use custom reordering functions (as long as they meet the requirements , see details)." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">extracat</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.7.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Reordering Categorical Data</h1>
    
    <div class="hidden name"><code>optile.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This function will take a categorical data object (<code>data.frame, table, ftable, matrix, array</code>) and optimize its category orders.
Most of the implemented techniques aim for a (pseudo-) diagonalization of the data matrix or table. This improves graphical representations (e.g. by minimizing crossings in <a href='scpcp.html'>scpcp</a> plots) and can also be useful to compute clusters (e.g. via <a href='cfluctile.html'>cfluctile</a>).</p>
<p>The function offers an interface which will by default return the same type of object that has been passed to the function such that it is possible to
write  <code>myplot( optile(x) )</code> for an optimized version of <code>myplot(x)</code>. 
It is possible to use custom reordering functions (as long as they meet the requirements , see details).</p>
    
    </div>

    <pre class="usage">optile(x, fun = "BCC",  foreign = NULL,
 args = list(), perm.cat = TRUE, method = NULL, iter = 1,
 freqvar = NULL, return.data = TRUE,
  return.type = "data.frame", vs = 0, tree = NULL, sym = FALSE, &#8230;)
 
 # S3 method for list
optile(x, fun = "BCC",  foreign = NULL,
 args = list(), perm.cat = TRUE, method = NULL, iter = 1,
 freqvar = NULL, return.data = TRUE, 
 return.type = "table", vs = 0, tree = NULL,
  sym = FALSE, k = NULL, h = NULL, &#8230;)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>The categorical data of one of the following classes:<br />
<code>data.frame, table, ftable, matrix, array</code></p></td>
    </tr>
    <tr>
      <th>fun</th>
      <td><p>The optimization function. Currently available are:<br />
<code>BCC, WBCC, CA, csvd , rmca, symmtile, barysort</code> and <code>IBCC</code>. For more information see details.</p></td>
    </tr>
    <tr>
      <th>foreign</th>
      <td><p>Where to find the optimization function <code>fun</code>. <code>NULL</code> for an R function or for instance <code>".Call"</code> and <code>.C</code> for an external function.<br />
E.g. <code>barysort</code> needs <code>foreign = ".Call"</code>.</p></td>
    </tr>
    <tr>
      <th>args</th>
      <td><p>further arguments which will be passed to <code>fun</code>.</p></td>
    </tr>
    <tr>
      <th>perm.cat</th>
      <td><p>A logical vector indicating which variables are reordered and which will remain untouched. 
For example <code>perm.cat = c(FALSE, TRUE)</code> means that only the second variable is reordered. Has no effect if <code>fun = "casort"</code>.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Either <code>NULL, "joint"</code> or <code>"stepwise"</code>. 
<code>method = NULL</code> means that the whole data table is passed to <code>fun</code>. <code>method = "joint"</code> uses the <a href='Burt.html'>Burt</a> matrix instead of the whole table which only reflects two-way associations not unlike a covariance matrix. 
<code>method = "stepwise"</code> will repeatedly call <code>fun</code> for 2, 3, 4, and so on variables.</p></td>
    </tr>
    <tr>
      <th>iter</th>
      <td><p>Some optimizations depend on the initial category orders (e.g. <code>"BCC"</code> and <code>"IBCC"</code>). If <code>iter &gt; 1</code> the optimization is repeated for <code>iter</code> random initial category orders and the best result is returned. In this case <code>fun</code> must return comparable values.</p></td>
    </tr>
    <tr>
      <th>freqvar</th>
      <td><p>The name of the frequency variable, if any.</p></td>
    </tr>
    <tr>
      <th>return.data</th>
      <td><p>Whether to return the data or just the new orders.</p></td>
    </tr>
    <tr>
      <th>return.type</th>
      <td><p>The class of the object which will be returned. Defaults to the input type.</p></td>
    </tr>
    <tr>
      <th>vs</th>
      <td><p>An optional version number. <code>"WBCC"</code> is currently equivalent to <code>"BCC"</code> and <code>vs =1</code></p></td>
    </tr>
    <tr>
      <th>tree</th>
      <td><p>A list whose entries are either tree objects (e.g. from <a href='https://www.rdocumentation.org/packages/stats/topics/hclust'>hclust</a>) or the string <code>"hc"</code>. If the i-th entry is a tree object, the i-th variable is the result from cutting the tree into <code>dim(x)[i]</code> clusters via <a href='subtree.html'>subtree</a>. <code>"hc"</code> will compute a hierarchical clustering for the rows and columns with arguments specified in <code>args</code>.</p></td>
    </tr>
    <tr>
      <th>sym</th>
      <td><p>If <code>fun</code> is <code>BCC</code> or <code>IBCC</code> it is possible to run a symmetric version of the algorithm by setting  <code>sym = TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>k</th>
      <td><p>A vector of integers specifying the numbers of clusters into which the tree objects shall be cut. See <a href='subtree.html'>subtree</a>.</p></td>
    </tr>
    <tr>
      <th>h</th>
      <td><p>Instead of a number of clusters <code>k</code> the height at which the dendrogram shall be cut can be specified. See <a href='subtree.html'>subtree</a>.</p></td>
    </tr>
    <tr>
      <th>&#8230;</th>
      <td><p>dots</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The <code>optile</code> interface makes it possible to resort the categories in different representations of categorical data.</p>
<p>The most important points to know are</p><table class='table'>
<tr><td></td></tr>
<tr><td>The function by default returns the same type of object as was passed in the function call.</td></tr>
<tr><td></td></tr>
<tr><td>It is possible to specify custom optimization functions via</td></tr>
<tr><td><code>fun</code></td></tr>
<tr><td>and</td></tr>
<tr><td><code>foreign</code></td></tr>
<tr><td>.</td></tr>
<tr><td></td></tr>
<tr><td>The function is able to handle tree objects which specify a hierarchical tree graph on the categories.</td></tr>
<tr><td></td></tr>
<tr><td>The function can pass either multidimensional tables,</td></tr>
<tr><td>the corresponding Burt matrix (</td></tr>
<tr><td><code>method = "joint"</code></td></tr>
<tr><td>)</td></tr>
<tr><td>or a hierarchical series of tables (</td></tr>
<tr><td><code>method = "stepwise"</code></td></tr>
<tr><td>) to the optimization functions.</td></tr>
<tr><td></td></tr>
</table>
    <p>How to add a custom optimization function:</p>
<p>It is possible to use custom functions for the optile interface as long as they meet the following requirements:</p>
<p>The function should have the form<br />
<code>fun( data, dims, perm.cat, ... )</code> or <br />
<code>foreign( "fun", data, dims, perm.cat, ...)</code> <br />
where fun is the name of the function and foreign is <code>".Call", ".C", ...</code></p>
<p>The function returns a vector of the new category orders (minus 1) and the resulting criterion, e.g. <code><a href='https://www.rdocumentation.org/packages/base/topics/c'>c( 0,2,4,1,3,  4,3,2,1,0,5,6,  0.7612 )</a></code></p>
<p><code>dims</code> is a vector with the number of categories for each variable and <code>perm.cat</code> is a 0/1 vector which indicates whether or not to change the category order of a variable.</p>
    <p>There are three possible types for the <code>data</code> argument of <code>fun</code> which can be set via <code>method</code>:</p>
<p>The argument <code>method</code> can be one of <code>NULL, "stepwise"</code> or <code>"joint"</code>.
The default <code>method = NULL</code> indicates that <code>fun</code> accepts a multidimensional table as for instance can be produced via <code>xtabs</code>.</p>
<p>If <code>method = "joint"</code> a Burt matrix is computed and passed to <code>fun</code> (c.f. <a href='Burt.html'>Burt</a>). For instance <code>"fun=casort"</code> uses this data representation.</p>
<p><code>method = "stepwise"</code> or <code>method = "sw"</code> passes <code>fun, data, foreign</code> as well as any <code>args</code> to a function called <code>steptile</code> which initially builds a 2-way table of the first pair of variables, passes it to fun and stores the computed category orders. Afterwards the other variables are added one by one. i.e. in a step for the k-th variable the function passes a k-way table to <code>fun</code> and a new category order for this variable is computed given the (already fixed) category orders of the variables 1 to k-1. This version is well suited for hierarchical visualizations like classical mosaicplots. A slightly different implementation which is not embedded in the optile framework but uses optile as its workhorse is <a href='steptile.html'>steptile</a>.</p>
<p>CURRENTLY AVAILABLE REORDERING FUNCTIONS:</p>
<p><code>"BCC"</code> and <code>"WBCC"</code>: minimize the Bertin Classification Criterion and the Weighted Bertin Classification Criterion.
BCC is the number of observation pairs which are not fully concordant among all relevant observation pairs (pairs which differ in all variables). A pair of observations <code>a</code> and <code>b</code> is fully concordant if all entries in <code>a</code> are smaller than those in <code>b</code> or vice versa. Full concordance results in a so-called pseudo-diagonal. WBCC uses the Hamming distance between the observations as weights for the contradictions to such a diagonal form and also takes pairs within the same row or column into account.</p>
<p><code>"casort"</code>: computes a correspondence analysis (SVD) and sorts by the first coordinate vector of each dimension. For more than two dimensions Multiple CA based on the Burt matrix is used.</p>
<p><code>"rmca"</code>: 
Adopts the idea of CA for k &gt; 2 dimensions without dropping information: For each dimension d = 1..k with categories d1...dr compute the scaled average k-1 dimensional profile sdd and perform an SVD of (sd1...sdr)-sdd. Like in correspondence analysis the first coordinate vector is used for the reordering.</p>
<p><code>"csvd"</code>:
For each variable d in 1..k (iteratively)
compute the cumulative sums over the multidimensional table for each variable except d. Transform this multidimensional table to an r x s matrix with r being the number of categories of variable d and s being the product of these numbers for all other variables.
Resort the categories of variable d by the first coordinate vector of an SVD of that matrix.
Repeat this procedure for all variables in turn until a stopping criterion is met.
Idea: for any variable h != d we have h1 &lt; h2 &lt; ... &lt; hx due to the cumulative sums. Hence the current order of the categories will (tend to) be the same as in the coordinates of the svd which means that the svd computes coordinates for variable d with respect to the current category orders of the other variables. The algorithm uses <code>casort</code> for an initial solution to start from.</p>
    <p><code>"distcor"</code>:
Two-way tables or matrices can also be optimized by means of the distance correlation. See <a href='dcor.html'>wdcor</a>.</p>
<p><code>"IBCC"</code>:
Iteratively sorts the categories of one variable at a time. Therefore it computes the average over the remaining dimensions and scales the profiles of each category as well as the average profile. It then computes the classification criterion between each category profile and the average profile which results in one value per category. The categories are then sorted by this criterion.
The procedure is very quick and yields good results in most cases. It strongly depends on the initial category orders as do the BCC or WBCC algorithms.
This function is written in C which means that <code>foreign =".Call"</code> must be set. Alternatively it can be used to presort the data via the shortcut <code>presort = TRUE</code> but this is deprecated and not recommended.</p>
<p><code>"distcor"</code>:
Two-way tables or matrices can also be optimized by means of the distance correlation. See <a href='dcor.html'>wdcor</a>.</p>
<p><code>"barysort"</code>:
Uses the barycenter heuristic to minimize the number of crossings heuristically. The heuristic is fast and yields good results but only works for two dimensions. For multiple dimensions use either <code>"IBCC"</code> or <a href='steptile.html'>steptile</a>.
In <code>optile</code> the barysort is implemented in C and therefore requires <code>foreign = ".Call")</code>.</p>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The function returns the reordered data. The return type is by default the same as the input type but can be redefined via <code>return.type</code>.</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Some parts of the code have been developed for the Google Summer of Code 2011.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># simple simulated example</span>
<span class='no'>A</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='arsim.html'>arsim</a></span>(<span class='fl'>2000</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>11</span>,<span class='fl'>13</span>),<span class='fl'>3</span>,<span class='fl'>0.3</span>)

<span class='fu'><a href='fluctile.html'>fluctile</a></span>(<span class='no'>A</span>)</div><div class='img'><img src='optile-1.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; viewport[base] </div><div class='input'><span class='fu'><a href='fluctile.html'>fluctile</a></span>(<span class='fu'>optile</span>(<span class='no'>A</span>))</div><div class='img'><img src='optile-2.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; viewport[base] </div><div class='input'><span class='fu'><a href='fluctile.html'>fluctile</a></span>(<span class='fu'>optile</span>(<span class='no'>A</span>, <span class='kw'>iter</span> <span class='kw'>=</span> <span class='fl'>100</span>))</div><div class='img'><img src='optile-3.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; viewport[base] </div><div class='input'><span class='fu'><a href='fluctile.html'>fluctile</a></span>(<span class='fu'>optile</span>(<span class='no'>A</span>, <span class='kw'>fun</span> <span class='kw'>=</span> <span class='st'>"CA"</span>))</div><div class='img'><img src='optile-4.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; viewport[base] </div><div class='input'><span class='fu'><a href='fluctile.html'>fluctile</a></span>(<span class='fu'>optile</span>(<span class='no'>A</span>, <span class='kw'>fun</span> <span class='kw'>=</span> <span class='st'>"barysort"</span>, <span class='kw'>foreign</span> <span class='kw'>=</span> <span class='st'>".Call"</span>))</div><div class='img'><img src='optile-5.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; viewport[base] </div><div class='input'>
<span class='co'># simulated mv example</span>
<span class='no'>A2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='arsim.html'>arsim</a></span>(<span class='fl'>20000</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>6</span>,<span class='fl'>7</span>,<span class='fl'>8</span>,<span class='fl'>9</span>),<span class='fl'>3</span>,<span class='fl'>0.1</span>)

<span class='fu'><a href='scpcp.html'>scpcp</a></span>(<span class='no'>A2</span>,<span class='kw'>sel</span><span class='kw'>=</span><span class='st'>"data[,1]"</span>)</div><div class='img'><img src='optile-6.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='fu'><a href='scpcp.html'>scpcp</a></span>(<span class='no'>A3</span> <span class='kw'>&lt;-</span> <span class='fu'>optile</span>(<span class='no'>A2</span>,<span class='kw'>iter</span><span class='kw'>=</span><span class='fl'>20</span>),<span class='kw'>sel</span><span class='kw'>=</span><span class='st'>"data[,1]"</span>)</div><div class='img'><img src='optile-7.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='fu'><a href='https://www.rdocumentation.org/packages/grDevices/topics/dev'>dev.new</a></span>()</div><div class='output co'>#&gt; <span class='message'>dev.new(): using pdf(file="Rplots99.pdf")</span></div><div class='input'><span class='fu'><a href='fluctile.html'>fluctile</a></span>(<span class='no'>A3</span>)</div><span class='co'># NOT RUN {</span>
<span class='co'>############ ------------ EXAMPLE I ------------ ############</span>
<span class='co'># ----- Cluster results from the Current Population Survey ----- #</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>CPScluster</span>)
<span class='no'>cpsX</span> <span class='kw'>=</span> <span class='fu'><a href='subtable.html'>subtable</a></span>(<span class='no'>CPScluster</span>,<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>5</span>, <span class='fl'>26</span>, <span class='fl'>34</span>, <span class='fl'>38</span>, <span class='fl'>39</span>), <span class='kw'>allfactor</span><span class='kw'>=</span><span class='fl'>TRUE</span>)

<span class='co'># joint and stepwise optimization of BCC</span>
<span class='no'>ss</span> <span class='kw'>&lt;-</span> <span class='fu'>optile</span>(<span class='no'>cpsX</span>,<span class='kw'>presort</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>return.data</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"joint"</span>)
<span class='no'>ss2</span> <span class='kw'>&lt;-</span> <span class='fu'>optile</span>(<span class='no'>cpsX</span>,<span class='kw'>presort</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>return.data</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"sw"</span>)

<span class='co'># original cpcp plot</span>
<span class='fu'>cpcp</span>(<span class='no'>cpsX</span>)

<span class='co'># cpcp for joint algorithm</span>
<span class='fu'>cpcp</span>(<span class='no'>ss</span>)

<span class='co'># cpcp and fluctuation for the stepwise algorithm</span>
<span class='co'># (should be good for pcp plots and hierarchical plots)</span>
<span class='fu'><a href='fluctile.html'>fluctile</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/xtabs'>xtabs</a></span>(<span class='no'>Freq</span>~<span class='no'>.</span>,<span class='kw'>data</span><span class='kw'>=</span><span class='no'>ss2</span>[,-<span class='fl'>4</span>]))
<span class='fu'>cpcp</span>(<span class='no'>ss2</span>)

<span class='co'># The multivariate algorithm</span>
<span class='no'>ss3</span> <span class='kw'>&lt;-</span> <span class='fu'>optile</span>(<span class='no'>cpsX</span>,<span class='kw'>presort</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>return.data</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='kw'>NULL</span>)
<span class='fu'>cpcp</span>(<span class='no'>ss3</span>)

<span class='co'># cpcp for casort algorithm</span>
<span class='no'>ssca</span> <span class='kw'>&lt;-</span> <span class='fu'>optile</span>(<span class='no'>cpsX</span>,<span class='kw'>presort</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>fun</span> <span class='kw'>=</span> <span class='st'>"casort"</span>, <span class='kw'>return.data</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"joint"</span>)
<span class='fu'>cpcp</span>(<span class='no'>ssca</span>)

<span class='co'># cpcp for rmca algorithm results. works better for the dmc data</span>
<span class='no'>ssR</span> <span class='kw'>&lt;-</span> <span class='fu'>optile</span>(<span class='no'>cpsX</span>,<span class='kw'>presort</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>fun</span> <span class='kw'>=</span> <span class='st'>"rmca"</span>, <span class='kw'>return.data</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='kw'>NULL</span>)
<span class='fu'>cpcp</span>(<span class='no'>ssR</span>)


<span class='co'># cpcp for csvd algorithm</span>
<span class='no'>ssC</span> <span class='kw'>&lt;-</span> <span class='fu'>optile</span>(<span class='no'>cpsX</span>,<span class='kw'>presort</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>fun</span> <span class='kw'>=</span> <span class='st'>"csvd"</span>, <span class='kw'>return.data</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='kw'>NULL</span>)
<span class='fu'><a href='fluctile.html'>fluctile</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/xtabs'>xtabs</a></span>(<span class='no'>Freq</span>~<span class='no'>.</span>,<span class='kw'>data</span><span class='kw'>=</span><span class='no'>ssC</span>[,-<span class='fl'>4</span>]))
<span class='fu'>cpcp</span>(<span class='no'>ssC</span>)

<span class='co'># cpcp for presort algorithm with 20 iterations</span>
<span class='no'>ssP</span> <span class='kw'>&lt;-</span> <span class='fu'>optile</span>(<span class='no'>cpsX</span>,<span class='kw'>presort</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>fun</span> <span class='kw'>=</span> <span class='st'>"IBCC"</span>,
<span class='kw'>return.data</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>foreign</span> <span class='kw'>=</span> <span class='st'>".Call"</span>,<span class='kw'>iter</span><span class='kw'>=</span><span class='fl'>20</span>)
<span class='fu'>cpcp</span>(<span class='no'>ssP</span>)

<span class='co'>############ ------------ EXAMPLE II ------------ ############</span>
<span class='co'># ------------------------------- Italian wines ------------------------------ #</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>MMST</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>wine</span>)

<span class='no'>swine</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/scale'>scale</a></span>(<span class='no'>wine</span>[,<span class='fl'>1</span>:<span class='fl'>13</span>])
<span class='no'>kmd</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/data.frame'>data.frame</a></span>(<span class='no'>wine</span>$<span class='no'>class</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/lapply'>replicate</a></span>(<span class='fl'>9</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/kmeans'>kmeans</a></span>(<span class='no'>swine</span>, <span class='kw'>centers</span> <span class='kw'>=</span> <span class='fl'>6</span>)$<span class='no'>cluster</span>) )
<span class='no'>kmd</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='subtable.html'>subtable</a></span>(<span class='no'>kmd</span>, <span class='fl'>1</span>:<span class='fl'>10</span>, <span class='kw'>allfactor</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='fu'>cpcp</span>(<span class='no'>kmd</span>)

<span class='co'># there is a good joint order and hence the joint result is better than the stepwise</span>
<span class='no'>kmd2</span> <span class='kw'>&lt;-</span> <span class='fu'>optile</span>(<span class='no'>kmd</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"sw"</span>)
<span class='no'>kmd3</span> <span class='kw'>&lt;-</span> <span class='fu'>optile</span>(<span class='no'>kmd</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"joint"</span>)

<span class='fu'>cpcp</span>(<span class='no'>kmd2</span>)
<span class='fu'>cpcp</span>(<span class='no'>kmd3</span>)



<span class='co'>############ ------------ EXAMPLE III ------------ ############</span>
<span class='co'># ---------------- The BicatYeast microarray dataset  ---------------- #</span>

<span class='co'># ----- with different clusterings for the genes ----- #</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>biclust</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>BicatYeast</span>)

<span class='no'>Dby</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/dist'>dist</a></span>(<span class='no'>BicatYeast</span>)

<span class='no'>hc1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/hclust'>hclust</a></span>(<span class='no'>Dby</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"ward"</span>)
<span class='no'>hc2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/hclust'>hclust</a></span>(<span class='no'>Dby</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"average"</span>)
<span class='no'>hc3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/hclust'>hclust</a></span>(<span class='no'>Dby</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"complete"</span>)

<span class='no'>hcc1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/cutree'>cutree</a></span>(<span class='no'>hc1</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='fl'>6</span>)
<span class='no'>hcc2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/cutree'>cutree</a></span>(<span class='no'>hc2</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='fl'>6</span>)
<span class='no'>hcc3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/cutree'>cutree</a></span>(<span class='no'>hc3</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='fl'>6</span>)

<span class='no'>km1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/kmeans'>kmeans</a></span>(<span class='no'>BicatYeast</span>, <span class='kw'>centers</span> <span class='kw'>=</span> <span class='fl'>6</span>, <span class='kw'>nstart</span> <span class='kw'>=</span> <span class='fl'>100</span>, <span class='kw'>iter.max</span> <span class='kw'>=</span> <span class='fl'>30</span>)$<span class='no'>cluster</span>

<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>mclust</span>)
<span class='no'>mc1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://mclust-org.github.io/mclust/reference/Mclust.html'>Mclust</a></span>(<span class='no'>BicatYeast</span>, <span class='kw'>G</span> <span class='kw'>=</span> <span class='fl'>6</span>)$<span class='no'>class</span>

<span class='no'>clusterings</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/data.frame'>data.frame</a></span>(<span class='no'>hcc1</span>,<span class='no'>hcc2</span>,<span class='no'>hcc3</span>,<span class='no'>km1</span>,<span class='no'>mc1</span>)
<span class='no'>clusterings</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='subtable.html'>subtable</a></span>(<span class='no'>clusterings</span>, <span class='fl'>1</span>:<span class='fl'>5</span>, <span class='kw'>allfactor</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='no'>clusterings2</span> <span class='kw'>&lt;-</span> <span class='fu'>optile</span>(<span class='no'>clusterings</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"joint"</span>)
<span class='no'>clusterings3</span> <span class='kw'>&lt;-</span> <span class='fu'>optile</span>(<span class='no'>clusterings</span>, <span class='kw'>fun</span> <span class='kw'>=</span> <span class='st'>"casort"</span>)

<span class='fu'>cpcp</span>(<span class='no'>clusterings2</span>)

<span class='co'># a fluctuation diagram of all but the avg. clustering</span>
<span class='fu'><a href='fluctile.html'>fluctile</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/xtabs'>xtabs</a></span>(<span class='no'>Freq</span>~<span class='no'>.</span>,<span class='kw'>data</span><span class='kw'>=</span><span class='no'>clusterings2</span>[,-<span class='fl'>2</span>]))

<span class='co'># compute agreement via Fleiss kappa in irr:</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>require</a></span>(<span class='no'>irr</span>)
<span class='no'>rawdata</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='untableSet.html'>untableSet</a></span>(<span class='no'>clusterings2</span>)
<span class='kw'>for</span>(<span class='no'>i</span> <span class='kw'>in</span> <span class='fl'>1</span>:<span class='fl'>5</span>) <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/levels'>levels</a></span>(<span class='no'>rawdata</span>[,<span class='no'>i</span>]) <span class='kw'>&lt;-</span> <span class='fl'>1</span>:<span class='fl'>6</span>
(<span class='fu'>kappam.fleiss</span>(<span class='no'>rawdata</span>))
(<span class='fu'>kappam.fleiss</span>(<span class='no'>rawdata</span>[,-<span class='fl'>2</span>]))


<span class='co'>## Let's have a look at kmeans with 2:12 clusters</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>biclust</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>BicatYeast</span>)

<span class='no'>cs</span> <span class='kw'>&lt;-</span> <span class='kw'>NULL</span>
<span class='kw'>for</span>(<span class='no'>i</span> <span class='kw'>in</span> <span class='fl'>2</span>:<span class='fl'>12</span>) <span class='no'>cs</span> <span class='kw'>&lt;-</span>  <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/cbind'>cbind</a></span>(<span class='no'>cs</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/kmeans'>kmeans</a></span>(<span class='no'>BicatYeast</span>, <span class='kw'>centers</span><span class='kw'>=</span><span class='no'>i</span>,<span class='kw'>nstart</span><span class='kw'>=</span><span class='fl'>100</span>)$<span class='no'>cluster</span>)
<span class='no'>cs</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/as.data.frame'>as.data.frame</a></span>(<span class='no'>cs</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/names'>names</a></span>(<span class='no'>cs</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/paste'>paste</a></span>(<span class='st'>"V"</span>,<span class='fl'>2</span>:<span class='fl'>12</span>,<span class='kw'>sep</span><span class='kw'>=</span><span class='st'>""</span>)
<span class='no'>ocs</span> <span class='kw'>&lt;-</span> <span class='fu'>optile</span>(<span class='no'>cs</span>,<span class='kw'>method</span><span class='kw'>=</span><span class='st'>"joint"</span>)
<span class='fu'>cpcp</span>(<span class='no'>ocs</span>,<span class='kw'>sort.individual</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='co'># and set alpha-blending, show.dots = TRUE</span>


<span class='co'># and with hierarchical clusterings</span>
<span class='no'>cs2</span> <span class='kw'>&lt;-</span> <span class='kw'>NULL</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>amap</span>)
<span class='no'>hc</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/amap/topics/hcluster'>hcluster</a></span>(<span class='no'>BicatYeast</span>)
<span class='kw'>for</span>(<span class='no'>i</span> <span class='kw'>in</span> <span class='fl'>2</span>:<span class='fl'>20</span>) <span class='no'>cs2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/cbind'>cbind</a></span>(<span class='no'>cs2</span>, <span class='fu'><a href='subtree.html'>subtree</a></span>(<span class='no'>hc</span>,<span class='kw'>k</span><span class='kw'>=</span><span class='no'>i</span>)$<span class='no'>data</span>)
<span class='no'>cs2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/as.data.frame'>as.data.frame</a></span>(<span class='no'>cs2</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/names'>names</a></span>(<span class='no'>cs2</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/paste'>paste</a></span>(<span class='st'>"V"</span>,<span class='fl'>2</span>:<span class='fl'>20</span>,<span class='kw'>sep</span><span class='kw'>=</span><span class='st'>""</span>)
<span class='fu'>cpcp</span>(<span class='no'>cs2</span>,<span class='kw'>sort.individual</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='co'># and set alpha-blending to about 0.6, show.dots = TRUE, then</span>
<span class='no'>ss</span> <span class='kw'>&lt;-</span> <span class='fu'>iset</span>()
<span class='fu'>ibar</span>(<span class='no'>ss</span>$<span class='no'>V6</span>)
<span class='co'># and VIEW &gt;&gt; Set color (rainbow)</span>
<span class='co'># Ideally the axes would be at a distance according to the heights of the cuts.</span>
<span class='co'># e.g. for the first 12 clusters (after that there are some cuts at about the same height)</span>

<span class='co'># the complete dendrogram doesn't look too attractive:</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>hc</span>)

<span class='co'># and plotting the top cuts only omits the information</span>
<span class='co'># on how many cases are in each node or leaf</span>

<span class='no'>xcoords</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rev'>rev</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/head'>tail</a></span>(<span class='no'>hc</span>$<span class='no'>height</span>,<span class='fl'>11</span>))
<span class='no'>xcoords</span> <span class='kw'>&lt;-</span> <span class='no'>xcoords</span>/<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Extremes'>max</a></span>(<span class='no'>hc</span>$<span class='no'>height</span>)
<span class='no'>ycoords</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/data.matrix'>data.matrix</a></span>(<span class='no'>ss</span>[,<span class='fl'>20</span>:<span class='fl'>30</span>])
<span class='no'>ycoords</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/apply'>apply</a></span>(<span class='no'>ycoords</span>,<span class='fl'>2</span>,<span class='kw'>function</span>(<span class='no'>s</span>){
        <span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='no'>s</span> - <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Extremes'>min</a></span>(<span class='no'>s</span>)
        <span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='no'>y</span>/<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Extremes'>max</a></span>(<span class='no'>y</span>)
        <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/function'>return</a></span>(<span class='no'>y</span>)
})
<span class='no'>ycoords</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/cbind'>cbind</a></span>(<span class='no'>ycoords</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/integer'>as.integer</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>as.matrix</a></span>(<span class='no'>ss</span>[,<span class='fl'>5</span>])))
<span class='no'>colv</span> <span class='kw'>&lt;-</span> <span class='fu'>rainbow_hcl</span>(<span class='fl'>6</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/grDevices/topics/dev'>dev.new</a></span>()
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/par'>par</a></span>(<span class='kw'>mfrow</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>2</span>))
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='fl'>1</span>,<span class='kw'>pch</span><span class='kw'>=</span><span class='st'>""</span>, <span class='kw'>xlim</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>), <span class='kw'>ylim</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Extremes'>min</a></span>(<span class='no'>xcoords</span>)-<span class='fl'>0.007</span>,<span class='fl'>1</span>))


<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/apply'>apply</a></span>(<span class='no'>ycoords</span>,<span class='fl'>1</span>,<span class='kw'>function</span>(<span class='no'>s</span>){
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/points'>points</a></span>(<span class='kw'>x</span><span class='kw'>=</span><span class='no'>s</span>[-<span class='fl'>12</span>], <span class='kw'>y</span><span class='kw'>=</span><span class='no'>xcoords</span>,)
        <span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/points'>points</a></span>(<span class='kw'>x</span><span class='kw'>=</span><span class='no'>s</span>[-<span class='fl'>12</span>],<span class='kw'>y</span><span class='kw'>=</span><span class='no'>xcoords</span>,<span class='kw'>pch</span><span class='kw'>=</span><span class='fl'>19</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='no'>colv</span>[<span class='no'>s</span>[<span class='fl'>12</span>]])
        <span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/lines'>lines</a></span>(<span class='kw'>x</span><span class='kw'>=</span><span class='no'>s</span>[-<span class='fl'>12</span>], <span class='kw'>y</span><span class='kw'>=</span><span class='no'>xcoords</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='no'>colv</span>[<span class='no'>s</span>[<span class='fl'>12</span>]])
})
<span class='no'>hc</span>$<span class='no'>height</span> <span class='kw'>&lt;-</span> <span class='no'>hc</span>$<span class='no'>height</span>/<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Extremes'>max</a></span>(<span class='no'>hc</span>$<span class='no'>height</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/stats-deprecated'>plclust</a></span>(<span class='fu'><a href='subtree.html'>subtree</a></span>(<span class='no'>hc</span>,<span class='fl'>12</span>),<span class='kw'>hang</span><span class='kw'>=</span><span class='fl'>0.02</span>)


<span class='co'>############ ------------ EXAMPLE IV ------------ ############</span>
<span class='co'># ------------------------- The Eisen Yeast data ------------------------- #</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>biclust</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>EisenYeast</span>)
<span class='no'>SEY</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/scale'>scale</a></span>(<span class='no'>EisenYeast</span>)

<span class='no'>Dby2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/dist'>dist</a></span>(<span class='no'>SEY</span>)

<span class='no'>hc1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/hclust'>hclust</a></span>(<span class='no'>Dby2</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"ward"</span>)
<span class='no'>hc2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/hclust'>hclust</a></span>(<span class='no'>Dby2</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"complete"</span>)

<span class='no'>hcc1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/cutree'>cutree</a></span>(<span class='no'>hc1</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='fl'>16</span>)
<span class='no'>km1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/kmeans'>kmeans</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/scale'>scale</a></span>(<span class='no'>EisenYeast</span>), <span class='kw'>centers</span> <span class='kw'>=</span> <span class='fl'>16</span>, <span class='kw'>nstart</span> <span class='kw'>=</span> <span class='fl'>20</span>, <span class='kw'>iter.max</span> <span class='kw'>=</span> <span class='fl'>30</span>)$<span class='no'>cluster</span>
<span class='fu'>optile</span>( <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/table'>table</a></span>(<span class='no'>hcc1</span>, <span class='no'>km1</span>) )


<span class='co'>############ ------------ EXAMPLE V ------------ ############</span>
<span class='co'># ------------------------- The Bicat Yeast data ------------------------- #</span>

<span class='co'># how many clusters are a good choice for kmeans?</span>
<span class='co'># one possible way to find out: </span>
<span class='co'># compute kmeans for 100 random initial settings, sort the results (clusters) </span>
<span class='co'># and compute their agreement</span>
<span class='co'># e.g. via Fleiss' Kappa (available in package irr)</span>

<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>require</a></span>(<span class='no'>biclust</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>BicatYeast</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>require</a></span>(<span class='no'>irr</span>)

<span class='no'>st</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Sys.time'>Sys.time</a></span>()
<span class='no'>fk</span> <span class='kw'>&lt;-</span> <span class='kw'>NULL</span>
<span class='kw'>for</span>(<span class='no'>k</span> <span class='kw'>in</span> <span class='fl'>3</span>:<span class='fl'>8</span>){
        <span class='no'>test</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='subtable.html'>subtable</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/lapply'>replicate</a></span>(<span class='fl'>100</span>,<span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/kmeans'>kmeans</a></span>(<span class='no'>BicatYeast</span>, <span class='kw'>centers</span> <span class='kw'>=</span> <span class='no'>k</span>)$<span class='no'>cluster</span>),<span class='fl'>1</span>:<span class='fl'>100</span>)
        <span class='no'>test</span> <span class='kw'>&lt;-</span> <span class='fu'>optile</span>(<span class='no'>test</span>, <span class='kw'>fun</span> <span class='kw'>=</span> <span class='st'>"casort"</span>)
        <span class='no'>test</span> <span class='kw'>&lt;-</span> <span class='fu'>optile</span>(<span class='no'>test</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"joint"</span>)
        <span class='no'>test</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='untableSet.html'>untableSet</a></span>(<span class='no'>test</span>)
        <span class='kw'>for</span>(<span class='no'>i</span> <span class='kw'>in</span> <span class='fl'>1</span>:<span class='fl'>100</span>) <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/levels'>levels</a></span>(<span class='no'>test</span>[,<span class='no'>i</span>]) <span class='kw'>&lt;-</span> <span class='fl'>1</span>:<span class='no'>k</span>
        <span class='no'>fk</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='no'>fk</span>,<span class='fu'>kappam.fleiss</span>(<span class='no'>test</span>)$<span class='no'>value</span>)
}
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Sys.time'>Sys.time</a></span>()-<span class='no'>st</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='fl'>3</span>:<span class='fl'>8</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>fk</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"l"</span>, <span class='kw'>lwd</span><span class='kw'>=</span><span class='fl'>2</span>)

<span class='co'>############ ------------ EXAMPLE VI ------------ ############</span>
<span class='co'># ------------------------- hierarchical clustering ------------------------- #</span>

<span class='co'># A list with hierarchical clustering objects:</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>require</a></span>(<span class='no'>amap</span>)

<span class='no'>hc1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/amap/topics/hcluster'>hcluster</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/t'>t</a></span>(<span class='no'>plants</span>[,-<span class='fl'>1</span>]), <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"manhattan"</span>, <span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"ward"</span>)
<span class='no'>hc2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/amap/topics/hcluster'>hcluster</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/t'>t</a></span>(<span class='no'>plants</span>[,-<span class='fl'>1</span>]), <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"manhattan"</span>, <span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"complete"</span>)

<span class='no'>hclist</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='no'>hc1</span>, <span class='no'>hc2</span>)
<span class='fu'><a href='tfluctile.html'>tfluctile</a></span>( <span class='fu'>optile</span>(<span class='no'>hclist</span>, <span class='kw'>k</span><span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>8</span>,<span class='fl'>8</span>) ) )

<span class='co'># or a table with corresponding tree objects:</span>

<span class='no'>tt</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/table'>table</a></span>( <span class='fu'><a href='subtree.html'>subtree</a></span>(<span class='no'>hc1</span>, <span class='fl'>12</span>)$<span class='no'>data</span>, <span class='fu'><a href='subtree.html'>subtree</a></span>(<span class='no'>hc2</span>, <span class='fl'>8</span>)$<span class='no'>data</span> )

<span class='fu'><a href='tfluctile.html'>tfluctile</a></span>(<span class='fu'>optile</span>(<span class='no'>tt</span>, <span class='kw'>tree</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='no'>hc1</span>, <span class='no'>hc2</span>)))

<span class='co'># only one tree object, the other variable is free:</span>

<span class='no'>tt</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/table'>table</a></span>( <span class='fu'><a href='subtree.html'>subtree</a></span>(<span class='no'>hc1</span>, <span class='fl'>8</span>)$<span class='no'>data</span>, <span class='no'>kk</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/kmeans'>kmeans</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/t'>t</a></span>(<span class='no'>plants</span>[,-<span class='fl'>1</span>]),<span class='kw'>centers</span><span class='kw'>=</span><span class='fl'>8</span>)$<span class='no'>cluster</span> )

<span class='fu'><a href='tfluctile.html'>tfluctile</a></span>(<span class='fu'>optile</span>(<span class='no'>tt</span>, <span class='kw'>tree</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='no'>hc1</span>, <span class='fl'>NA</span>)))

<span class='co'># }</span><div class='input'>



</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#note">Note</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Alexander Pilhoefer<br />
Department for Computer Oriented Statistics and Data Analysis<br />
University of Augsburg<br />
Germany</p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Alexander Pilhoefer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

